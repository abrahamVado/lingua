# File: pds_recipe_template.routing.yml
# Notes:
# - All entity references use numeric IDs.
# - Use '\d+' to enforce integers at routing level.
# - Unsafe methods (POST/PATCH/DELETE) require CSRF via _csrf_token: 'TRUE'.
# - _format: json helps content negotiation.

pds_recipe_template.ensure_group:
  path: '/pds-template/ensure-group/{id}'
  defaults:
    _controller: '\Drupal\pds_recipe_template\Controller\GroupController::ensureGroup'
    _title: 'Ensure PDS Template group'
    _format: 'json'
  requirements:
    _permission: 'access content'
    id: '\d+'
    _csrf_token: 'TRUE'
  methods: ['POST']

pds_recipe_template.debug_table:
  path: '/admin/reports/pds-template/debug-table/{table}'
  defaults:
    _controller: '\Drupal\pds_recipe_template\Controller\DebugController::table'
  requirements:
    _permission: 'access content'
    table: '[a-z0-9_]+'
  options:
    _admin_route: true

pds_recipe_template.resolve_row:
  path: '/pds-template/resolve-row/{id}'
  defaults:
    _controller: '\Drupal\pds_recipe_template\Plugin\Block\PdsTemplateBlock::ajaxResolveRow'
    _title: 'Resolve PDS Template row'
    _format: 'json'
  requirements:
    _permission: 'access content'
    id: '\d+'
    _csrf_token: 'TRUE'
  methods: ['POST']

pds_recipe_template.delete_row:
  path: '/pds-template/delete-row/{id}/{row_id}'
  defaults:
    _controller: '\Drupal\pds_recipe_template\Controller\RowController::delete'
    _title: 'Delete PDS Template row'
    _format: 'json'
  requirements:
    _permission: 'access content'
    id: '\d+'
    row_id: '\d+'
    _csrf_token: 'TRUE'
  methods: ['DELETE','POST']

pds_recipe_template.create_row:
  path: '/pds-template/create-row/{id}'
  defaults:
    _controller: '\Drupal\pds_recipe_template\Controller\RowController::createRow'
    _title: 'Create PDS Template row'
    _format: 'json'
  requirements:
    _permission: 'access content'
    id: '\d+'
    _csrf_token: 'TRUE'
  methods: ['POST']

pds_recipe_template.update_row:
  path: '/pds-template/update-row/{id}/{row_id}'
  defaults:
    _controller: '\Drupal\pds_recipe_template\Controller\RowController::update'
    _title: 'Update PDS Template row'
    _format: 'json'
  requirements:
    _permission: 'access content'
    id: '\d+'
    row_id: '\d+'
    _csrf_token: 'TRUE'
  methods: ['PATCH','POST']

pds_recipe_template.list_rows:
  path: '/pds-template/list-rows/{id}'
  defaults:
    _controller: '\Drupal\pds_recipe_template\Controller\RowController::list'
    _title: 'List PDS Template rows'
    _format: 'json'
  requirements:
    _permission: 'access content'
    id: '\d+'
  methods: ['GET']
